# 로또 분석 및 생성 시스템

## 목차
1. [시스템 개요](#시스템-개요)
2. [설치 및 설정](#설치-및-설정)
3. [기본 설정값](#기본-설정값)
4. [설정 조정 방법](#설정-조정-방법)
5. [주요 기능 상세](#주요-기능-상세)
6. [사용 예시](#사용-예시)
7. [기술 스펙](#기술-스펙)

## 시스템 개요

이 시스템은 로또 번호의 다양한 수학적, 통계적 특성을 분석하고, 이를 바탕으로 최적화된 번호 조합을 생성하는 고급 분석/생성 시스템입니다.

### 핵심 구성요소
- **분석 엔진**: 45개의 기본 번호에 대한 20가지 이상의 특성 분석
- **생성 엔진**: 15가지 이상의 검증 기준을 통과하는 번호 조합 생성
- **데이터베이스**: SQLite 기반의 당첨 번호 저장 및 분석 시스템

## 설치 및 설정

### 필수 요구사항
```
- Python 3.7+
- SQLite3
- pandas
- numpy
```

### 설치 방법
```bash
pip install -r requirements.txt
```

## 기본 설정값

### 1. 번호 범위 제한
- **총합 범위**: 100 ~ 175
- **AC값 범위**: 7 ~ 10
- **시작번호 최대값**: 15
- **끝번호 최소값**: 35

### 2. 숫자 특성 제한
- **소수 개수**: 1 ~ 3개
- **합성수 개수**: 1 ~ 3개
- **3의 배수**: 1 ~ 3개
- **4의 배수**: 1 ~ 2개
- **5의 배수**: 0 ~ 2개
- **쌍수**: 0 ~ 2개
- **모서리 번호**: 1 ~ 4개

### 3. 패턴 제한
- **연속번호**: 
  - 연속번호 없음 허용
  - 연속번호 쌍 1~2개 허용
- **끝수 동일 개수**: 2 ~ 3개
- **끝수 총합**: 15 ~ 35
- **구간별 번호 수**: 0 ~ 3개
- **사용 색상 수**: 3 ~ 5개

### 4. 특수 번호 그룹
```python
모서리 번호 = {
    '좌측 상단': [1, 2, 8, 9],
    '우측 상단': [6, 7, 13, 14],
    '좌측 하단': [29, 30, 36, 37, 43, 44],
    '우측 하단': [34, 35, 41, 42]
}

볼 색상 = {
    '노랑(🟡)': 1-10,
    '파랑(🔵)': 11-20,
    '빨강(🔴)': 21-30,
    '검정(⚫)': 31-40,
    '초록(🟢)': 41-45
}
```

## 설정 조정 방법

### 1. config.py 설정 변경
기본 설정값은 `config.py`의 `FILTER_CRITERIA` 딕셔너리에서 조정할 수 있습니다:

```python
FILTER_CRITERIA = {
    'sum_range': {'min': 100, 'max': 175},  # 총합 범위 조정
    'ac_range': {'min': 7, 'max': 10},      # AC값 범위 조정
    # ... 기타 설정들
}
```

### 2. 주요 조정 가능 항목

#### a) 기본 범위 조정
```python
'sum_range': {'min': 원하는_최소값, 'max': 원하는_최대값}
'ac_range': {'min': 원하는_최소값, 'max': 원하는_최대값}
```

#### b) 숫자 특성 개수 조정
```python
'number_counts': {
    'prime_numbers': {'min': 원하는_최소값, 'max': 원하는_최대값},
    'composite_numbers': {'min': 원하는_최소값, 'max': 원하는_최대값},
    # ... 기타 설정들
}
```

#### c) 패턴 제한 조정
```python
'consecutive_numbers': {
    'none': True/False,  # 연속번호 없음 허용 여부
    'pairs': [허용할_연속번호_쌍의_개수_리스트]
}
```

## 주요 기능 상세

### 1. 번호 분석 기능 (LottoAnalyzer)

#### a) 기본 분석
- AC(Adjacency Criteria) 값 계산
- 연속 번호 패턴 분석
- 색상 분포 분석
- 구간별 번호 분포 분석

#### b) 특수 번호 분석
- 소수/합성수 분석
- 완전제곱수 분석
- 회문수/쌍수 분석
- 동형수 그룹 분석

#### c) 통계 분석
- 빈도 분석
- 패턴 분석
- 종합 통계 계산

### 2. 번호 생성 기능 (LottoGenerator)

#### a) 기본 생성 로직
1. 랜덤 번호 6개 생성
2. 15가지 검증 기준 적용
3. 모든 기준 통과 시 유효 번호로 인정

#### b) 검증 프로세스
1. 총합 검증
2. AC값 검증
3. 홀짝 비율 검증
4. 고저 번호 비율 검증
5. 끝자리 숫자 검증
6. 연속번호 패턴 검증
7. 특수 번호 개수 검증
8. 구간별 분포 검증
9. 색상 조합 검증

## 사용 예시

### 1. 번호 분석
```python
from lotto_analyzer import LottoAnalyzer

analyzer = LottoAnalyzer("lotto.db")
# 전체 분석 실행
freq_dfs, stats_df = analyzer.analyze_numbers()
# 분석 결과 출력
analyzer.print_analysis_results()
```

### 2. 번호 생성
```python
from lotto_generator import LottoGenerator

generator = LottoGenerator("lotto.db")
# 5개의 번호 조합 생성
combinations = generator.generate_numbers(5)
```

## 기술 스펙

### 데이터베이스 스키마
```sql
CREATE TABLE lotto_results (
    draw_number INTEGER PRIMARY KEY,
    num1 INTEGER,
    num2 INTEGER,
    num3 INTEGER,
    num4 INTEGER,
    num5 INTEGER,
    num6 INTEGER
);
```

### 성능 특성
- 단일 번호 조합 분석: ~0.1초
- 번호 생성: 평균 1-2초/조합
- 데이터베이스 조회: ~0.05초
- 전체 분석: ~1-2초

### 메모리 사용량
- 기본 실행: ~50MB
- 전체 분석 시: ~100-150MB
---
# 로또 시스템 기술 상세 문서

## 1. AC(Adjacency Criteria) 값 분석

AC(Adjacency Criteria)는 번호들 간의 간격 다양성을 측정하는 핵심 지표입니다.

### 계산 과정
1. 모든 번호 쌍의 차이값 계산
2. 중복을 제거한 차이값의 개수 계산
3. 기본값 5를 뺀 결과가 AC값

### 특징
- AC값이 높을수록 번호 간격이 다양함을 의미
- 최적 범위인 7-10은 적절한 간격 다양성을 보장

## 2. 색상 분석 시스템

### 기본 색상 구분
| 색상 | 번호 범위 | 의미 |
|------|-----------|------|
| 노랑(🟡) | 1-10 | 초반 저번호대 |
| 파랑(🔵) | 11-20 | 중반 저번호대 |
| 빨강(🔴) | 21-30 | 초반 고번호대 |
| 검정(⚫) | 31-40 | 중반 고번호대 |
| 초록(🟢) | 41-45 | 최고번호대 |

### 색상 제한
- 최소 3가지 색상 사용
- 최대 5가지 색상 사용
- 색상 조합 분석으로 번호의 균형적 분포 확인

## 3. 특수 번호 그룹

### 모서리 번호
- 복권용지의 물리적 위치 기반
- 심리적 선택 패턴 반영
- 1-4개 사이로 제한하여 균형 유지

### 동형수 그룹
- 숫자를 뒤집어도 유효한 로또 번호가 되는 수들
- 예시: 12-21, 13-31, 14-41 등
- 심리적 선택 패턴에 대한 보정 역할

## 4. 검증 시스템 세부 로직

### 홀짝 비율 검증
- 극단적 비율(0:6 또는 6:0) 제외
- 균형잡힌 분포 유도

### 고저 번호 비율
- 1-22: 저번호로 분류
- 23-45: 고번호로 분류
- 극단적 비율 제외

## 5. 연속번호 처리 로직

### 기본 규칙
- 연속번호 없음 허용
- 1-2개의 연속번호 쌍 허용
- 3개 이상의 연속번호는 제외

### 연속번호 검출 알고리즘
```python
def find_consecutive_numbers(numbers):
    sorted_nums = sorted(numbers)
    consecutive_groups = []
    current_group = [sorted_nums[0]]
    
    for i in range(1, len(sorted_nums)):
        if sorted_nums[i] == sorted_nums[i-1] + 1:
            current_group.append(sorted_nums[i])
        else:
            if len(current_group) >= 2:
                consecutive_groups.append(current_group)
            current_group = [sorted_nums[i]]
    
    if len(current_group) >= 2:
        consecutive_groups.append(current_group)
    
    return consecutive_groups
```

## 6. 데이터베이스 처리 시스템

### SQLite 선택 이유
- 가벼운 파일 기반 데이터베이스
- 별도 서버 불필요
- 빠른 읽기 성능

### 데이터 처리 최적화
- pandas 활용한 효율적 데이터 처리
- 메모리 캐싱으로 반복 분석 성능 향상

## 7. 성능 최적화 특징

### 최적화 전략
- 번호 생성 시 early return 패턴 사용
- 캐싱된 분석 결과 재활용

### 효율적인 검증 순서
1. 빠른 검증 항목 우선 실행
2. 복잡한 계산 항목 후순위 배치
3. 실패 가능성 높은 항목 우선 검증

## 결론

이 시스템은 단순한 난수 생성이 아닌, 수학적 특성과 통계적 패턴을 고려한 정교한 번호 생성 시스템입니다. 
각각의 기술적 요소들이 유기적으로 결합되어 최적화된 로또 번호 조합을 생성합니다.